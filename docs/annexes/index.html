<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-annexes">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RNDFP191TE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RNDFP191TE",{anonymize_ip:!0})</script><title data-rh="true">Annexes | Handpoint</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developer-ecomm.handpoint.com/docs/annexes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Annexes | Handpoint"><meta data-rh="true" name="description" content="Signature Calculation"><meta data-rh="true" property="og:description" content="Signature Calculation"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://developer-ecomm.handpoint.com/docs/annexes"><link data-rh="true" rel="alternate" href="https://developer-ecomm.handpoint.com/docs/annexes" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer-ecomm.handpoint.com/docs/annexes" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0c32ab46.css">
<link rel="preload" href="/assets/js/runtime~main.810139ba.js" as="script">
<link rel="preload" href="/assets/js/main.e69a6561.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://developer.handpoint.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj" width="175"><img src="/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU" width="175"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/cnpdocs">Online Payments Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/handpoint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/transactiontypes">Transaction Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/integrationlibraries">Integration Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/avscv2checking">AVS/CV2 Checking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3dsecure">3D Secure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/annexes">Annexes</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Annexes</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Annexes</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="signatureCalculation">Signature Calculation<a class="hash-link" href="#signatureCalculation" title="Direct link to heading">‚Äã</a></h2><p>It is highly recommended that transactions are protected using message signing. The signing process offers a quick and simple way to ensure that the message came from an authorised source and has not been tampered with during transmission.</p><p>Signing, however, must be completed on your servers and never left for the Customer‚Äôs browser to complete in JavaScript, as this would mean revealing your secret signature code to anyone who viewed the JavaScript code in the browser.</p><p>Signatures are especially important when a transaction is sent from a browser‚Äôs payment form via the use of hidden form fields because the Customer can easily use tools built into their browser to modify these hidden fields and change items such as the amount they should be charged.</p><p>Care must be taken to ensure that fields are sorted before signing into ascending field name order according to their numeric ASCII value. Some languages natural sort routines do NOT use ASCII order by default and so need to be adjusted or alternative methods used.</p><p>Also, when signing requests with fields formatted as per the <a href="/docs/overview#fieldFormats">format guide</a>, only the root integration field is included in any sorting as the sub-fields are part of the value and should not have their order changed. The sub-fields must then be sent in the same order as they were hashed if added as hidden fields in HTML forms etc.
The section below gives a step-by-step example of how to sign a transaction, complete with coding examples using the PHP language.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="example-signature-key">Example Signature Key:<a class="hash-link" href="#example-signature-key" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$key = &#x27;DontTellAnyone&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="example-transaction">Example Transaction<a class="hash-link" href="#example-transaction" title="Direct link to heading">‚Äã</a></h3><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$tran = array ( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;merchantID&#x27; =&gt; &#x27;100001&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;action&#x27; =&gt; &#x27;SALE&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;type&#x27; =&gt; &#x27;1&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;currencyCode&#x27; =&gt; &#x27;826&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;countryCode&#x27; =&gt; &#x27;826&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;amount&#x27; =&gt; &#x27;2691&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;transactionUnique&#x27; =&gt; &#x27;55f025addd3c2&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;orderRef&#x27; =&gt; &#x27;Signature Test&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;cardNumber&#x27; =&gt; &#x27;4929 4212 3460 0821&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;cardExpiryDate&#x27; =&gt; &#x27;1213&#x27;, )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>The transaction used for signature calculation must not include any &#x27;signature&#x27; field as this will be added after signing when its value is known.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-1---sort-transaction-values-by-their-field-name">Step 1 - Sort transaction values by their field name<a class="hash-link" href="#step-1---sort-transaction-values-by-their-field-name" title="Direct link to heading">‚Äã</a></h3><p>Transaction fields must be in ascending field name order according to their numeric ASCII value.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ksort($tran);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">array ( &#x27;action&#x27; =&gt; &#x27;SALE&#x27;, &#x27;amount&#x27; =&gt; &#x27;2691&#x27;, &#x27;cardExpiryDate&#x27; =&gt; &#x27;1213&#x27;, &#x27;cardNumber&#x27; =&gt; &#x27;4929 4212 3460 0821&#x27;, &#x27;countryCode&#x27; =&gt; &#x27;826&#x27;, &#x27;currencyCode&#x27; =&gt; &#x27;826&#x27;, &#x27;merchantID&#x27; =&gt; &#x27;100001&#x27;, &#x27;orderRef&#x27; =&gt; &#x27;Signature Test&#x27;, &#x27;transactionUnique&#x27; =&gt; &#x27;55f025addd3c2&#x27;, &#x27;type&#x27; =&gt; &#x27;1&#x27; )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-2---create-url-encoded-string-from-sorted-fields">Step 2 - Create url encoded string from sorted fields<a class="hash-link" href="#step-2---create-url-encoded-string-from-sorted-fields" title="Direct link to heading">‚Äã</a></h3><p>Use RFC 1738 and the application/x-www-form-urlencoded media type, which implies that spaces are encoded as plus (+) signs.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$str = http_build_query($tran, &#x27;&#x27;, &#x27;&amp;&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=SALE&amp;amount=2691&amp;cardExpiryDate=1213&amp;cardNumber=4929+4212+3460+0821&amp;countryCode=826&amp;currencyCode=826&amp;merchantID=100001&amp;orderRef=Signature+Test&amp;transactionUnique=55f025addd3c2&amp;type=1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-3---normalise-all-line-endings-in-the-url-encoded-string">Step 3 - Normalise all line endings in the url encoded string<a class="hash-link" href="#step-3---normalise-all-line-endings-in-the-url-encoded-string" title="Direct link to heading">‚Äã</a></h3><p>Convert all CR NL, NL CR, CR character sequences to a single NL character.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$str = str_replace(array(&#x27;%0D%0A&#x27;, &#x27;%0A%0D&#x27;, &#x27;%0D&#x27;), &#x27;%0A&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=SALE&amp;amount=2691&amp;cardExpiryDate=1213&amp;cardNumber=4929+4212+3460+0821&amp;countryCode=826&amp;currencyCode=826&amp;merchantID=100001&amp;orderRef=Signature+Test&amp;transactionUnique=55f025addd3c2&amp;type=1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-4---append-your-signature-key-to-the-normalised-string">Step 4 - Append your signature key to the normalised string<a class="hash-link" href="#step-4---append-your-signature-key-to-the-normalised-string" title="Direct link to heading">‚Äã</a></h3><p>The signature key is appended to the normalised string with no separator characters.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$str .= &#x27;DontTellAnyone&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=SALE&amp;amount=2691&amp;cardExpiryDate=1213&amp;cardNumber=4929+4212+3460+0821&amp;countryCode=826&amp;currencyCode=826&amp;merchantID=100001&amp;orderRef=Signature+Test&amp;transactionUnique=55f025addd3c2&amp;type=1DontTellAnyone</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-5---hash-the-string-using-the-sha-512-algorithm">Step 5 - Hash the string using the SHA-512 algorithm<a class="hash-link" href="#step-5---hash-the-string-using-the-sha-512-algorithm" title="Direct link to heading">‚Äã</a></h3><p>The normalised string is hashed to a more compact value using the secure SHA-512 hashing algorithm.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$signature = hash(&#x27;SHA512&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">da0acd2c404945365d0e7ae74ad32d57c561e9b942f6bdb7e3dda49a08fcddf74fe6af6b23b8481b8dc8895c12fc21c72c69d60f137fdf574720363e33d94097</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-6---add-the-signature-to-the-transaction-form-or-post-data">Step 6 - Add the signature to the transaction form or post data<a class="hash-link" href="#step-6---add-the-signature-to-the-transaction-form-or-post-data" title="Direct link to heading">‚Äã</a></h3><p>The signature should be sent as part of the transaction in a field called &#x27;signature&#x27;.</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;input type=&quot;hidden&quot; name=&quot;signature&quot; value=&quot;&lt;?=$signature?&gt;&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$tran[&#x27;signature&#x27;] = $signature;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="captureDelay">Capture Delay<a class="hash-link" href="#captureDelay" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">‚Äã</a></h3><p>Capture Delay enables you to specify a delay between the authorisation of a payment and its capture. This allows you time to verify the order and choose whether to fulfil it or cancel it. This can be very helpful in preventing chargebacks due to fraud.</p><p>When NOT using capture delay, payments are authorised and captured immediately - funds are automatically debited from the Customer‚Äôs credit or debit card at that time.</p><p>When using capture delay, the payment is authorised only at the time of payment - funds are reserved against the credit or debit card and will not be debited until the payment is captured. </p><p>The Customer experience with capture delay is the same as when capture delay is not used. The Customer will not know whether you are using capture delay or not.</p><p>If you choose to use capture delay, you can use the captureDelay request field to specify the number of days for which capture is delayed, within a range of 0 to 30 days. Alternatively, you can use the value -1 or ‚Äònever‚Äô to specify that the Gateway should never automatically capture in which case you must manually capture.</p><p>The Gateway will automatically capture the transaction after any delay specified unless you manually cancel or capture the transaction, using either the Direct Integration or via the Merchant Management System (MMS).</p><p>Note that some cards require capture within 4 to 5 days - if payment is not automatically captured within that period, the transaction will expire, and the reserved funds will be released to the Customer.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="why-use-capture-delay">Why Use Capture Delay?<a class="hash-link" href="#why-use-capture-delay" title="Direct link to heading">‚Äã</a></h3><p>Capture delay allows you to accept online orders normally but allows you to cancel any transactions that you cannot or will not fulfil, thereby reducing the risks of chargeback. If you receive an order that appears to be fraudulent or that you cannot or do not wish to fulfil, you can simply cancel the transaction.</p><p>Note: Cancelling a transaction may not always reverse the authorisation and release the funds back to the Customer. This is dependent on the Acquirer and in these cases the authorisation will never be settled and will be left to expire releasing any reserved funds. The time taken for this varies between cards.</p><p>Some Acquirers do not support delayed capture, in which case the Hosted Integration will return a responseCode of 66358 (INVALID CAPTURE DELAY).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="transaction-types">Transaction Types<a class="hash-link" href="#transaction-types" title="Direct link to heading">‚Äã</a></h2><p>The Gateway supports card not present (CNP) types of transactions, made where the Cardholder does not or cannot physically present the card for your visual examination at the time that an order is placed and payment effected.
The type of transaction required is specified using the <code>type</code> request field when performing a new payment transaction.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="e-commerce-ecom">E-Commerce (ECOM)<a class="hash-link" href="#e-commerce-ecom" title="Direct link to heading">‚Äã</a></h3><p>E-commerce transactions are supported by the Gateway by using a transaction type of 1. They are designed for you to accept payments via a website, such as a shopping cart payment. E-commerce transactions MUST use advance fraud detection, such as 3-D Secure.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="mail-ordertelephone-order-moto">Mail Order/Telephone Order (MOTO)<a class="hash-link" href="#mail-ordertelephone-order-moto" title="Direct link to heading">‚Äã</a></h3><p>Mail Order/Telephone Order transactions are supported by the Gateway by using a transaction type of 2. They are designed for you to build your own virtual terminal system to enter remote order details. MOTO transactions cannot use 3-D Secure as the cardholder is not able to perform the challenge.</p><p>Your Acquirer may need to enable MOTO capabilities on your main acquiring account, or they provide a separate acquiring account which will be available through its own Gateway Merchant Account.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="continuous-authority-ca">Continuous Authority (CA)<a class="hash-link" href="#continuous-authority-ca" title="Direct link to heading">‚Äã</a></h3><p>Continuous Authority transactions are supported by the Gateway by using a transaction type of 9. They are designed for you to make subscription transactions. </p><p>The following transaction types are considered as Continuous Authority (CA) Payments :</p><ul><li><p>Instalment Payments: A transaction in a series of transactions that use a stored credential and that represent Consumer agreement for the merchant to initiate one or more future transactions over a period for a single purchase of goods or services. An example of such a transaction is a higher purchase repayment.</p></li><li><p>Recurring Payments: A transaction in a series of transactions that use a stored credential and that are processed at fixed, regular intervals (not to exceed one year between transactions), representing Consumer agreement for the merchant to initiate future transactions for the purchase of goods or services provided at regular intervals. An example of such a transaction is a gym membership subscription.</p></li></ul><p>Your Acquirer may need to enable Continuous Authority capabilities on your main acquiring account, or they provide a separate acquiring account which will be available through its own Gateway Merchant Account.</p><p>The Gateway offers a means of automating the taking of regular CA transactions using Recurring Transaction Agreements (RTA) as detailed in section 12.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/3dsecure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3D Secure</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#signatureCalculation" class="table-of-contents__link toc-highlight">Signature Calculation</a><ul><li><a href="#example-signature-key" class="table-of-contents__link toc-highlight">Example Signature Key:</a></li><li><a href="#example-transaction" class="table-of-contents__link toc-highlight">Example Transaction</a></li><li><a href="#step-1---sort-transaction-values-by-their-field-name" class="table-of-contents__link toc-highlight">Step 1 - Sort transaction values by their field name</a></li><li><a href="#step-2---create-url-encoded-string-from-sorted-fields" class="table-of-contents__link toc-highlight">Step 2 - Create url encoded string from sorted fields</a></li><li><a href="#step-3---normalise-all-line-endings-in-the-url-encoded-string" class="table-of-contents__link toc-highlight">Step 3 - Normalise all line endings in the url encoded string</a></li><li><a href="#step-4---append-your-signature-key-to-the-normalised-string" class="table-of-contents__link toc-highlight">Step 4 - Append your signature key to the normalised string</a></li><li><a href="#step-5---hash-the-string-using-the-sha-512-algorithm" class="table-of-contents__link toc-highlight">Step 5 - Hash the string using the SHA-512 algorithm</a></li><li><a href="#step-6---add-the-signature-to-the-transaction-form-or-post-data" class="table-of-contents__link toc-highlight">Step 6 - Add the signature to the transaction form or post data</a></li></ul></li><li><a href="#captureDelay" class="table-of-contents__link toc-highlight">Capture Delay</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#why-use-capture-delay" class="table-of-contents__link toc-highlight">Why Use Capture Delay?</a></li></ul></li><li><a href="#transaction-types" class="table-of-contents__link toc-highlight">Transaction Types</a><ul><li><a href="#e-commerce-ecom" class="table-of-contents__link toc-highlight">E-Commerce (ECOM)</a></li><li><a href="#mail-ordertelephone-order-moto" class="table-of-contents__link toc-highlight">Mail Order/Telephone Order (MOTO)</a></li><li><a href="#continuous-authority-ca" class="table-of-contents__link toc-highlight">Continuous Authority (CA)</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a href="https://developer.handpoint.com/cpdocs/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">In-Person Payments Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/cnpdocs/index.html">Online Payments Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Handpoint Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/handpointltd?lang=en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Get our Apps</div><ul class="footer__items"><li class="footer__item"><a href="https://play.google.com/store/apps/details?id=com.handpoint.hipos&amp;hl=en&amp;gl=US&amp;pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get it on Google Play<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://apps.apple.com/us/app/handpoint/id1450546788?itsct=apps_box_link&amp;itscg=30200" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download on the App Store<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://status.handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Handpoint Status Page<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://handpoint.atlassian.net/wiki/spaces/PD/overview?homepageId=5898250" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://handpoint.us6.list-manage.com/subscribe?u=4d9dff9e7edb7e57a67a7b252&amp;id=0a2179241e" target="_blank" rel="noopener noreferrer" class="footer__link-item">Subscribe to the Handpoint Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.handpoint.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_gHmE"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2022 Handpoint</div></div></div></footer></div>
<script src="/assets/js/runtime~main.810139ba.js"></script>
<script src="/assets/js/main.e69a6561.js"></script>
</body>
</html>